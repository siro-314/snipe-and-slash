# Snipe and Slash VRã‚²ãƒ¼ãƒ  - å¼•ãç¶™ããƒ•ã‚¡ã‚¤ãƒ«

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç›®çš„ï¼ˆåˆ¤æ–­ã®è»¸ï¼‰
- **ç›®æ¨™**: 1268è¡Œã®å·¨å¤§main.jsã‚’TypeScriptåŒ–ã—ã€ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ç§»è¡Œ
- **åˆ¤æ–­åŸºæº–**: ç–çµåˆã€æ‹¡å¼µæ€§ã€å …ç‰¢æ€§ã‚’é‡è¦–ã—ãŸã‚¯ãƒªãƒ¼ãƒ³ã‚³ãƒ¼ãƒ‰
- **å„ªå…ˆé †ä½**: 
  1. æ—¢å­˜æ©Ÿèƒ½ã®100%ä¿æŒï¼ˆå‹•ä½œä¿è¨¼ï¼‰
  2. æ®µéšçš„ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ï¼ˆæ€¥ãŒãªã„ï¼‰
  3. VRå®Ÿæ©Ÿç¢ºèªã¯Phase 5ã¾ã§å¾Œå›ã—

## 2. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒãƒƒãƒ—ã¨å½¹å‰²

```
snipe-and-slash/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ domain/              # ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆPure Stateï¼‰
â”‚   â”‚   â”œâ”€â”€ gameState.ts     # âœ… GameStateManagerï¼ˆçŠ¶æ…‹ç®¡ç†ï¼‰
â”‚   â”‚   â””â”€â”€ types.ts         # âœ… å‹å®šç¾©
â”‚   â”œâ”€â”€ managers/            # ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼å±¤
â”‚   â”‚   â”œâ”€â”€ modelManager.ts  # âœ… ModelManagerï¼ˆGLTFãƒ­ãƒ¼ãƒ€ãƒ¼ï¼‰
â”‚   â”‚   â””â”€â”€ hudManager.ts    # âœ… HUDManagerï¼ˆUIæ›´æ–°ï¼‰
â”‚   â”œâ”€â”€ utils/               # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚   â””â”€â”€ helpers.ts       # âœ… ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
â”‚   â”œâ”€â”€ components/          # ğŸš§ A-Frameã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆPhase 4äºˆå®šï¼‰
â”‚   â”‚   â”œâ”€â”€ weapons/
â”‚   â”‚   â””â”€â”€ enemies/
â”‚   â””â”€â”€ main.ts              # âœ… 1193è¡Œï¼ˆPhase 3å®Œäº†ï¼‰
â”œâ”€â”€ REFACTORING_PLAN.md      # âœ… å…¨ä½“è¨ˆç”»ï¼ˆPhase 0-7ï¼‰
â””â”€â”€ å¼•ãç¶™ã.md              # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
```

## 3. æŠ€è¡“é¸å®šã¨åˆ¶ç´„

### TypeScriptç’°å¢ƒ
- **Vite**: é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ï¼ˆhttp://localhost:8080ï¼‰
- **ãƒ“ãƒ«ãƒ‰**: `npm run build` â†’ dist/ã«å‡ºåŠ›ï¼ˆmain-B14rv-Ck.js 243.18kBï¼‰
- **ç†ç”±**: é«˜é€ŸHMRã€A-Frame/Three.jså¯¾å¿œã€VRé–‹ç™ºå‘ã

### Phaseæˆ¦ç•¥ï¼ˆå…¨7ãƒ•ã‚§ãƒ¼ã‚ºï¼‰
- **Phase 0**: âœ… è¨ˆç”»æ›¸ä½œæˆå®Œäº†
- **Phase 1**: âœ… TypeScriptç’°å¢ƒæ§‹ç¯‰å®Œäº†
- **Phase 2**: âœ… ãƒ•ã‚¡ã‚¤ãƒ«åˆ†å‰²å®Œäº†ï¼ˆ468è¡Œã®æ–°è¦ã‚³ãƒ¼ãƒ‰ä½œæˆï¼‰
  - GameStateManager, ModelManager, HUDManager, Helpers
  - Gitã‚³ãƒŸãƒƒãƒˆ: `phase-2-complete`
- **Phase 3**: âœ… **å®Œäº†ï¼** - ã‚¯ãƒ©ã‚¹åŒ–ãƒ»ä¾å­˜æ€§æ³¨å…¥
  - âœ… GameStateManagerçµ±åˆå®Œäº†
  - âœ… ModelManagerçµ±åˆå®Œäº†
  - âœ… HUDManagerçµ±åˆå®Œäº†
  - âœ… äº’æ›æ€§ãƒ©ãƒƒãƒ‘ãƒ¼å‰Šé™¤å®Œäº†
  - Gitã‚³ãƒŸãƒƒãƒˆ: `phase-3-complete`

### åˆ¶ç´„äº‹é …
- **Three.jså¤šé‡ã‚¤ãƒ³ãƒãƒ¼ãƒˆ**: Phase 4ã§ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«çµ±åˆäºˆå®š
- **A-Frameå‹å®šç¾©**: è¤‡é›‘ãªãŸã‚anyå‹ã§ä¸€æ—¦å›é¿ï¼ˆPhase 6ã§æ”¹å–„ï¼‰
- **VRç¢ºèª**: Quest 2å®Ÿæ©Ÿã¯Phase 5ä»¥é™

## 4. ç¾çŠ¶ã¨æ¬¡ã®ä¸€æ‰‹

### âœ… Phase 3å®Œäº†ï¼ï¼ˆ2026-02-10 23:24ï¼‰

**æˆæœ**:
- main.ts: 1268è¡Œ â†’ 1193è¡Œï¼ˆ75è¡Œå‰Šæ¸›ï¼‰
- ãƒ“ãƒ«ãƒ‰ã‚µã‚¤ã‚º: 243.18kBï¼ˆgzip 66.06kBï¼‰
- äº’æ›æ€§ãƒ©ãƒƒãƒ‘ãƒ¼å‰Šé™¤: GameStateãƒ»ModelManagerä¸¡æ–¹å‰Šé™¤
- ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°å‰Šæ¸›: å®Œäº†

**Gitã‚³ãƒŸãƒƒãƒˆ**:
```bash
commit a03df9f
tag: phase-3-complete
```

---

### ğŸš€ Phase 4: A-Frameã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ†å‰²ï¼ˆæ¬¡ã®ä½œæ¥­ï¼‰

**ç›®çš„**: main.tsã®A-Frameã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å€‹åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ†é›¢

**ä½œæ¥­å†…å®¹**:
```typescript
src/components/
â”œâ”€â”€ weapons/
â”‚   â”œâ”€â”€ swordComponent.ts     // AFRAME.registerComponent('sword')
â”‚   â”œâ”€â”€ bowComponent.ts       // AFRAME.registerComponent('bow')
â”‚   â””â”€â”€ projectileComponent.ts
â”œâ”€â”€ enemies/
â”‚   â”œâ”€â”€ enemyMobile.ts        // AFRAME.registerComponent('enemy-mobile')
â”‚   â”œâ”€â”€ enemyTurret.ts        // AFRAME.registerComponent('enemy-turret')
â”‚   â””â”€â”€ enemyDroneBlack.ts
â””â”€â”€ ui/
    â””â”€â”€ weaponSelector.ts     // AFRAME.registerComponent('weapon-selector')
```

**Phase 4ã®è©³ç´°ã‚¹ãƒ†ãƒƒãƒ—**:
1. swordã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæŠ½å‡ºï¼ˆ200è¡Œç¨‹åº¦ï¼‰
2. bowã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæŠ½å‡ºï¼ˆ150è¡Œç¨‹åº¦ï¼‰
3. enemy-mobileã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæŠ½å‡ºï¼ˆ180è¡Œç¨‹åº¦ï¼‰
4. enemy-turretã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæŠ½å‡ºï¼ˆ200è¡Œç¨‹åº¦ï¼‰
5. enemy-drone-blackã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæŠ½å‡ºï¼ˆ150è¡Œç¨‹åº¦ï¼‰
6. weapon-selectorã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæŠ½å‡ºï¼ˆ50è¡Œç¨‹åº¦ï¼‰
7. å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¸ã®ä¾å­˜æ€§æ³¨å…¥ï¼ˆgameState, modelManagerï¼‰

**Phase 4å®Œäº†å¾Œã®main.ts**: ç´„200-300è¡Œã¾ã§å‰Šæ¸›äºˆå®š

**å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ï¼ˆPhase 4é–‹å§‹æ™‚ï¼‰**:
```bash
# 1. swordã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæŠ½å‡º
cd ~/Desktop/snipe-and-slash
mkdir -p src/components/weapons

# 2. main.tsã‹ã‚‰swordã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆéƒ¨åˆ†ã‚’ã‚³ãƒ”ãƒ¼
# ï¼ˆç´„200è¡Œï¼‰

# 3. src/components/weapons/swordComponent.tsã‚’ä½œæˆ

# 4. main.tsã‹ã‚‰è©²å½“éƒ¨åˆ†ã‚’å‰Šé™¤ã—ã¦importæ–‡è¿½åŠ 

# 5. ãƒ“ãƒ«ãƒ‰ç¢ºèª
npm run build

# 6. å‹•ä½œç¢ºèªå¾Œã‚³ãƒŸãƒƒãƒˆ
git add -A
git commit -m "feat(phase4): swordã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ†å‰²"
```

---

### ğŸ¤” å¦¥å”ãƒã‚¤ãƒ³ãƒˆãƒ»å¾Œå›ã—ã«ã—ãŸã“ã¨

#### 1. A-Frameå‹å®šç¾©ã®ä¸å®Œå…¨æ€§
```typescript
// ç¾çŠ¶: anyå‹ã§å›é¿
el: any,
data: any,

// ç†æƒ³: å®Œå…¨ãªå‹å®šç¾©
el: AFRAME.AEntity,
data: ComponentData,
```
**Phase 6ã§å¯¾å¿œäºˆå®š**

#### 2. Three.jså¤šé‡ã‚¤ãƒ³ãƒãƒ¼ãƒˆè­¦å‘Š
```
WARNING: Multiple instances of Three.js being imported
```
**Phase 6ã§å¯¾å¿œäºˆå®š**: ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«çµ±åˆ

#### 3. ãƒ“ãƒ«ãƒ‰ã‚µã‚¤ã‚ºã®å¢—åŠ 
```
Phase 2: 22.99kB â†’ Phase 3: 243.18kBï¼ˆç´„10å€ï¼‰
```
**è©•ä¾¡**: gzipå¾Œ66.06kBã¯è¨±å®¹ç¯„å›²  
**Phase 6ã§æ¤œè¨**: Tree Shakingæœ€é©åŒ–

#### 4. ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã®å®Œå…¨å‰Šé™¤ã¯æœªå®Œäº†
```typescript
// ã¾ã æ®‹ã£ã¦ã„ã‚‹å¯èƒ½æ€§
let enemySpawnInterval: number;
let updateHUDInterval: number;
```
**Phase 6ã§å¯¾å¿œäºˆå®š**

---

### ğŸ“‹ Phase 5ä»¥é™ã®äºˆå®š

- **Phase 5**: VRå®Ÿæ©Ÿç¢ºèªãƒ»ãƒã‚°ä¿®æ­£ï¼ˆ3-4æ™‚é–“ï¼‰
  - Quest 2ã§ã®å‹•ä½œç¢ºèª
  - ãƒã‚°ä¿®æ­£
- **Phase 6**: æœ€é©åŒ–ãƒ»ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ï¼ˆ2-3æ™‚é–“ï¼‰
  - å‹å®šç¾©ã®å¼·åŒ–
  - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
  - ã‚³ãƒ¼ãƒ‰å“è³ªå‘ä¸Š
- **Phase 7**: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™ï¼ˆ1-2æ™‚é–“ï¼‰
  - README.md
  - API_DESIGN.md
  - TROUBLESHOOTING.md

---

**æ›´æ–°æ—¥æ™‚**: 2026-02-10 23:24  
**GitçŠ¶æ…‹**: phase-3-complete âœ…  
**ãƒ“ãƒ«ãƒ‰**: âœ… æˆåŠŸï¼ˆ243.18kB gzipped 66.06kBï¼‰  
**é–‹ç™ºã‚µãƒ¼ãƒãƒ¼**: http://localhost:8080  
**æ¬¡ã®ã‚¿ã‚¹ã‚¯**: Phase 4ï¼ˆA-Frameã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ†å‰²ï¼‰ã¾ãŸã¯Phase 5ï¼ˆVRå®Ÿæ©Ÿç¢ºèªï¼‰
